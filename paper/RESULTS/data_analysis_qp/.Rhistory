library(tidyverse)
library(lme4)
library(ggplot2)
library(papaja)
library(tinylabels)
library(car)
library(broom)
library(emmeans)
library(reshape2)
library(writexl)
library(readxl)
library(dplyr)
qp_data_raw_1 <- read_excel("~/Library/Mobile Documents/com~apple~CloudDocs/rutgers/phd/second_year/QP/paper/RESULTS/qp_data_analysis/data/qp_data_raw_1.xlsx")
qp_data_raw_1 <- read_excel("~/Library/Mobile Documents/com~apple~CloudDocs/rutgers/phd/second_year/QP/paper/RESULTS/qp_data_analysis/data/qp_data_raw_1.xls")
qp_data <- qp_data_raw_1[-(100:126),]
knitr::kable(head(qp_data$political_orientation))
qp_data$age <- as.numeric(qp_data$age)
summary(qp_data$age)
qp_data$mother_tongue <- factor(qp_data$mother_tongue, levels = c("Catalan", "Both", "Spanish", "Other(s)"))
library(tidyverse)
library(lme4)
library(ggplot2)
library(papaja)
library(tinylabels)
library(car)
library(broom)
library(emmeans)
library(reshape2)
library(writexl)
library(readxl)
library(dplyr)
library(tidyverse)
library(lme4)
library(ggplot2)
library(papaja)
library(tinylabels)
library(car)
library(broom)
library(emmeans)
library(reshape2)
library(writexl)
library(readxl)
library(dplyr)
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
mutate(language = case_when(
language == "catalan" ~ "Catalan",
language == "spanish" ~ "Spanish",
TRUE ~ "Prop"
)) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
mutate(language = case_when(
language == "catalan" ~ "Catalan",
language == "spanish" ~ "Spanish",
TRUE ~ "Prop"
)) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data |>
select(catalan_proficiency_understand:spanish_proficiency_write) |>
pivot_longer(
col = catalan_proficiency_understand:spanish_proficiency_write,
names_to = "Skills",
values_to = "avg"
) |>
separate(Skills, into = c("language", "Skills"), sep = 7) |>
mutate(Skills = stringr::str_remove(Skills, "\\_proficiency\\_")) |>
mutate(language = case_when(
language == "catalan" ~ "Catalan",
language == "spanish" ~ "Spanish",
TRUE ~ "Prop"
)) |>
group_by(language, Skills) |>
count(avg) |>
mutate(prop = n / 99) |>
ggplot() +
aes(x = Skills, y = prop, fill = language) +
geom_bar(stat = "identity", position = "dodge")
qp_data %>%
ggplot(
aes(x = Balearic_Islands_language_residents_learn, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
qp_data %>%
group_by(Balearic_Islands_language_residents_learn, gender) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_language_residents_learn, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
ggplot(
aes(x = Balearic_Islands_native_language, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
qp_data %>%
group_by(Balearic_Islands_native_language, gender, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_native_language, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
group_by(Balearic_Islands_native_language, gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_native_language, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ family_income)
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
group_by(mother_tongue, gender, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = mother_tongue, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
group_by(Balearic_Islands_host_language_immigrants, gender) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_host_language_immigrants, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
group_by(Balearic_Islands_official_language, gender) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_official_language, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
ggplot(
aes(x = Balearic_Islands_should_speak, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
qp_data %>%
group_by(Balearic_Islands_should_speak, gender) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_should_speak, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
summary(qp_data$political_orientation)
summary(qp_data$age)
qp_data$political_orientation
plot(table(qp_data$political_orientation))
table(qp_data$political_orientation)
table(filter(qp_data, political_orientation == "Center-Right"))
# Create a table with the counts
table_political_orientation_mother_tongue <- data.frame(
Political_Orientation = c("Far left", "Left", "Center-Left"),
Mother_Tongue = c("Catalan", "Catalan", "Catalan"),
Count = c(count_far_left_catalan, count_left_catalan, count_center_left_catalan)
)
ggplot(
data = qp_data,
aes(
x = political_orientation, fill = political_orientation)) +
geom_bar() +
scale_fill_manual(values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue"))
ggplot(
data = qp_data,
aes(
x = political_orientation,
fill = political_orientation)) +
geom_bar() +
scale_x_discrete(labels = c("Far left" = "Far-Left")) +
scale_fill_manual(values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue")) +
labs(y = "Count", fill = "Political orientation", x = "Political orientation")
ggplot(
data = qp_data,
aes(
x = political_orientation,
fill = political_orientation)) +
geom_bar() +
scale_x_discrete(labels = c("Far left" = "Far-Left")) +
scale_fill_manual(
values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue"),
name = "Political orientation") +  # Set the legend title
labs(y = "Count", x = "Political orientation")
qp_data$political_orientation <- factor(qp_data$political_orientation, levels = c("Far left", "Left", "Center-Left", "Centre", "Center-Right", "Right"))
ggplot(
data = qp_data,
aes(
x = political_orientation,
fill = political_orientation)) +
geom_bar() +
scale_x_discrete(labels = c("Far left" = "Far-Left")) +
scale_fill_manual(
values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue"),
name = "Political orientation") +  # Set the legend title
labs(y = "Count", x = "Political orientation")
ggplot(
data = qp_data,
aes(
x = political_orientation,
fill = political_orientation)) +
geom_bar() +
scale_x_discrete(labels = c("Far left" = "Far-Left")) +
scale_fill_manual(values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue")) +
labs(y = "Count", fill = "Political orientation", x = "Political orientation")
barplot(table(qp_data$political_orientation), col = colors, main = "Political Orientation Bar Plot", xlab = "Frequency", ylab = "Political Orientation", las = 1)
# Create a color bar plot
barplot(table(qp_data$political_orientation), col = colors, main = "Political Orientation Bar Plot", xlab = "Political Orientation", ylab = "Frequency", las = 1)
# Create a table with the counts
table_political_orientation_mother_tongue <- data.frame(
Political_Orientation = c("Far left", "Left", "Center-Left"),
Count = c(count_far_left_catalan, count_left_catalan, count_center_left_catalan)
)
center_left_catalan <- qp_data %>% filter(political_orientation == "Center-Left")
left_catalan <- qp_data %>% filter(political_orientation == "Left")
# Assuming 'qp_data' is your dataframe
# You can use the filter function from dplyr to create subsets based on conditions
far_left_catalan <- qp_data %>% filter(political_orientation == "Far left")
# Count the number of rows in each subset
count_far_left_catalan <- nrow(far_left_catalan)
count_left_catalan <- nrow(left_catalan)
count_center_left_catalan <- nrow(center_left_catalan)
# Create a table with the counts
table_political_orientation_mother_tongue <- data.frame(
Political_Orientation = c("Far left", "Left", "Center-Left"),
Count = c(count_far_left_catalan, count_left_catalan, count_center_left_catalan)
)
print(table_political_orientation_mother_tongue)
plot(plot1<-qp_data %>%
ggplot() +
aes(x=gender, fill=political_orientation) +
geom_bar(stat="count", position="dodge"))
gender_summary <- qp_data %>%
group_by(gender) %>%
summarise(
total_count = n(),
avg_age = mean(age, na.rm = TRUE),
sd_age = sd(age, na.rm = TRUE)
) %>%
bind_rows(qp_data %>%
summarise(
gender = "Total",
total_count = n(),
avg_age = mean(age, na.rm = TRUE),
sd_age = sd(age, na.rm = TRUE)
)) %>%
rename(
'Gender' = gender,
'Total Count' = total_count,
'Average Age' = avg_age,
'SD' = sd_age
)
print(gender_summary)
knitr::kable(gender_summary)
pivot_wider(names_from = gender, values_from = c(total_count, avg_age, sd_age))
plot(plot1<-qp_data %>%
ggplot() +
aes(x=gender, fill=political_orientation) +
geom_bar(stat="count", position="dodge"))
plot(plot <- qp_data %>%
ggplot() +
aes(x=gender, y=age, col=age) +
geom_point(na.rm = TRUE))
# Aggregate the data by political orientation and mother tongue
agg_data <- qp_data %>%
filter(mother_tongue != "Other(s)") %>%
group_by(political_orientation, mother_tongue) %>%
summarise(count = n()) %>%
mutate(percent = count / sum(count)) # Calculate percentage
# Plotting
ggplot(agg_data, aes(x = political_orientation, y = percent, fill = mother_tongue)) +
geom_bar(stat = "identity", position = "fill") +
ylab("Percentage") +
facet_wrap(~ mother_tongue) + # Facet by mother tongue
theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x-axis labels if necessary
qp_data %>%
ggplot(aes(x = gender, fill = catalan_proficiency_speak)) +
geom_bar(stat = "count", position = "dodge")
qp_data %>%
ggplot(aes(x = catalan_proficiency_speak, fill = gender)) +
geom_bar(stat = "count", position = "dodge")
qp_data %>%
filter(language_used_with_children != "Others") %>%
filter(language_used_with_children != "N/A") %>%
ggplot(aes(x = gender, fill = language_used_with_children)) +
geom_bar(stat = "count", position = "dodge")
qp_data %>%
ggplot(
aes(x = Balearic_Islands_native_language, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
ggplot(
data = qp_data,
aes(
x = political_orientation,
fill = political_orientation)) +
geom_bar() +
scale_x_discrete(labels = c("Far left" = "Far-Left")) +
scale_fill_manual(
values = c("indianred2", "indianred2", "indianred2", "cornflowerblue", "cornflowerblue", "cornflowerblue"),
name = "Political orientation") +  # Set the legend title
labs(y = "Count", x = "Political orientation")
plot(plot1<-qp_data %>%
ggplot() +
aes(x=gender, fill=political_orientation) +
geom_bar(stat="count", position="dodge"))
plot(plot <- qp_data %>%
ggplot() +
aes(x=gender, y=age, col=age) +
geom_point(na.rm = TRUE))
plot(plot1<-qp_data %>%
ggplot() +
aes(x=political_orientation, fill=gender) +
geom_bar(stat="count", position="dodge"))
plot(plot1<-qp_data %>%
ggplot() +
aes(x=political_orientation, fill=gender) +
geom_bar(stat="count", position="stack"))
qp_data %>%
ggplot(aes(x = gender, y = age, color = political_orientation)) +
geom_boxplot()
qp_data %>%
group_by(gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = gender, y = count, fill = family_income)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
filter(family_income != "I prefer not to say") %>%
group_by(gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = gender, y = count, fill = family_income)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
filter(family_income != "I prefer not to say") %>%
group_by(gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = gender, y = count, fill = family_income)) +
geom_bar(stat = "identity", position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
ggplot(aes(x = gender, fill = mother_tongue)) +
geom_bar(stat = "count", position = "dodge")
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
ggplot(aes(x = gender, fill = mother_tongue)) +
geom_bar(stat = "count", position = "stack")
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
ggplot(aes(x = political_orientation, fill = mother_tongue)) +
geom_bar(stat = "count", position = "fill") +
labs(y = "Count", fill = "Mother tongue", x = "Political orientation")
qp_data %>%
ggplot(aes(x = political_orientation, fill = mother_tongue)) +
geom_bar(stat = "count", position = "fill")
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
ggplot(aes(x = gender, fill = mother_tongue)) +
geom_bar(stat = "count", position = "fill") +
facet_grid(~ political_orientation)
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
ggplot(aes(x = gender, fill = mother_tongue)) +
geom_bar(stat = "count", position = "dodge")
qp_data %>%
group_by(Balearic_Islands_host_language_immigrants, gender) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_host_language_immigrants, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
qp_data %>%
ggplot(
aes(x = Balearic_Islands_language_institutional_acts, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
group_by(mother_tongue, gender, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = mother_tongue, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
group_by(mother_tongue, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = mother_tongue, y = count, fill = mother_tongue)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
filter(mother_tongue != "Other(s)") %>%
group_by(mother_tongue, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = , y = mother_tongue, fill = mother_tongue)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
group_by(Balearic_Islands_native_language, gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_native_language, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ family_income)
qp_data %>%
group_by(Balearic_Islands_native_language, gender, political_orientation) %>%
summarise(count = n()) %>%
ggplot(aes(x = Balearic_Islands_native_language, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "stack") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_grid(~ political_orientation)
qp_data %>%
ggplot(
aes(x = Balearic_Islands_native_language, fill = gender)) +
geom_bar(position = "dodge", stat = "count")
plot(plot1<-qp_data %>%
ggplot() +
aes(x=gender, fill=political_orientation) +
geom_bar(stat="count", position="dodge"))
plot(plot <- qp_data %>%
ggplot() +
aes(x=gender, y=age, col=age) +
geom_point(na.rm = TRUE))
plot(plot1<-qp_data %>%
ggplot() +
aes(x=political_orientation, fill=gender) +
geom_bar(stat="count", position="dodge"))
plot(plot1<-qp_data %>%
ggplot() +
aes(x=political_orientation, fill=gender) +
geom_bar(stat="count", position="stack"))
qp_data %>%
ggplot(aes(x = gender, y = age, color = political_orientation)) +
geom_boxplot()
qp_data %>%
filter(family_income != "I prefer not to say") %>%
group_by(gender, family_income) %>%
summarise(count = n()) %>%
ggplot(aes(x = gender, y = count, fill = family_income)) +
geom_bar(stat = "identity", position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
mod_null_Spanish_is_a_difficult_language_to_learn <- lm(Spanish_is_a_difficult_language_to_learn ~ 1, data = qp_data)
# Rename the column
names(qp_data)[names(qp_data) == "Spanish _is_a_difficult_language_to_learn"] <- "Spanish_is_a_difficult_language_to_learn"
mod_null_Spanish_is_a_difficult_language_to_learn <- lm(Spanish_is_a_difficult_language_to_learn ~ 1, data = qp_data)
mod_null_I_live_in_the_Balearic_Islands_and_I_have_to_know_study_and_use_Catalan <- lm(I_live_in_the_Balearic_Islands_and_I_have_to_know_study_and_use_Catalan ~ 1, data = qp_data)
# Rename the column
names(qp_data)[names(qp_data) == "I_live_in_the_Balearic_Islands_and_I have_to_know_study_and_use_Catalan"] <- "I_live_in_the_Balearic_Islands_and_I_have_to_know_study_and_use_Catalan"
mod_null_I_live_in_the_Balearic_Islands_and_I_have_to_know_study_and_use_Catalan <- lm(I_live_in_the_Balearic_Islands_and_I_have_to_know_study_and_use_Catalan ~ 1, data = qp_data)
qp_data_raw_1 <- read_excel("~/Library/Mobile Documents/com~apple~CloudDocs/rutgers/phd/second_year/QP/paper/RESULTS/data/qp_data_raw_1.xls")
